---
layout: default
link: md-file/
---
<div id="show-div"></div>
<script type="module">
    const baseurl = w$.location.href;
    const url = baseurl.replace("{{ page.link }}", "");
    const div = $("#show-div");
    if (url !== Url + "/") {
        div.html(`
<div>
    <h1>正在加载……</h1>
    <p>如果长时间没有反应，请检查链接是否正确。</p>
</div>`);
        try {
            const data = await loadFile(url);
            const parser = new DOMParser();
            const fileDoc = parser.parseFromString(data, "text/html");
            const add = $(fileDoc).find(".add-md");
            add.each(function() {
                console.log(this);
            });
            const newDoc = $(parser.parseFromString("<!DOCTYPE html><html></html>", "text/html"));
            add.each(function() {
                const item = $(this);
                item.removeClass("add-md");
                if (item.prop("tagName") === "head") {
                    newDoc.find("head").append(item.html());
                } else {
                    newDoc.find("body").append(item);
                }
            });
            $("html").html(newDoc.find("html").html());
        } catch (error) {
            console.error("loading error!", error);
            getError(error.code);
        }
    }else{
        div.html(`
<h1>md-file功能</h1>
<p>更纯洁的站内Markdown展示。</p>
`);
    }
</script>
